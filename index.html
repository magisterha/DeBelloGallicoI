<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análisis de De Bello Gallico I, 1</title>
    
    <style type="text/css">
        /* --- Tailwind CSS Pre-compilado (Preflight & Utilitarios Usados) --- */
        *,::before,::after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::before,::after{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,[type='button'],[type='reset'],[type='submit']{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type='search']{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item; cursor: pointer;}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button, [role="button"]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}
        .mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-10{margin-bottom:2.5rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.my-6{margin-top:1.5rem;margin-bottom:1.5rem}
        .block{display:block}.h-screen{height:100vh}.w-80{width:20rem}
        .overflow-y-auto{overflow-y:auto}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}
        .border-b-2{border-bottom-width:2px}.border-stone-300{--tw-border-opacity:1;border-color:rgb(214 211 209 / var(--tw-border-opacity))}
        .bg-stone-100{--tw-bg-opacity:1;background-color:rgb(245 245 244 / var(--tw-bg-opacity))}
        .bg-stone-200{--tw-bg-opacity:1;background-color:rgb(231 229 228 / var(--tw-bg-opacity))}
        .bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}
        .p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.pb-5{padding-bottom:1.25rem}
        .text-center{text-align:center}.text-justify{text-align:justify}
        .text-2xl{font-size:1.5rem;line-height:2rem}.text-5xl{font-size:3rem;line-height:1}
        .text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}
        .font-bold{font-weight:700}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-relaxed{line-height:1.625}.tracking-wider{letter-spacing:0.05em}
        .text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity))}
        .text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity))}
        .text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity))}
        .text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity))}
        .shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}
        .shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}
        .transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;-webkit-backdrop-filter:backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}
        .space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}
        .space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}
        @media (min-width:1024px){.lg\:p-12{padding:3rem}}

        /* --- Estilos Personalizados --- */
        body{background-color:#f3f0e9;font-family:'Helvetica Neue',Arial,sans-serif;color:#4a4a4a}
        .textum-classicum{font-family:'Georgia','Times New Roman',serif}
        .verbum{cursor:pointer;transition:background-color .2s ease-in-out, box-shadow .2s ease-in-out; border-radius: 0.25rem; padding: 0 0.1rem;}
        .verbum:hover{background-color:#ede6d6}
        .activus{background-color:#cbbca7!important;font-weight:700}
        
        /* --- ESTILOS PARA EL SELECTOR DE IDIOMA --- */
        #language-switcher { display: flex; gap: 0.5rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 1rem; }
        .lang-btn { flex-grow: 1; padding: 0.5rem; border: 1px solid #d6d3d1; background-color: #f5f5f4; color: #57534e; border-radius: 0.375rem; cursor: pointer; font-weight: 600; transition: background-color 0.2s, color 0.2s; font-size: 0.875rem;}
        .lang-btn:hover { background-color: #e7e5e4; }
        .lang-btn.active-lang { background-color: #4a4a4a; color: #ffffff; border-color: #4a4a4a; }
        
        /* --- ESTILOS PARA MENÚS DESPLEGABLES --- */
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        details > summary::before { content: '▶'; margin-right: 0.5rem; font-size: 0.8em; transition: transform 0.2s; }
        details[open] > summary::before { transform: rotate(90deg); }
        details .details-content { padding-left: 1.2rem; margin-top: 0.5rem; border-left: 2px solid #e5e7eb; }

        /* --- LAYOUT RESPONSIVO (Móvil Primero) --- */
        .main-layout { padding: 1rem; padding-bottom: calc(45vh + 2rem); }
        #marginalia-sinistra { position: fixed; bottom: 0; left: 0; right: 0; width: 100%; height: 45vh; z-index: 50; border-top: 2px solid #d6d3d1; box-shadow: 0 -4px 10px rgba(0,0,0,0.1); transform: translateY(0); transition: transform 0.3s ease-in-out; }
        
        /* --- LAYOUT PARA ORDENADOR --- */
        @media (min-width: 1024px) {
            .main-layout {
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 2rem;
                padding: 2rem;
            }
            #marginalia-sinistra {
                position: sticky;
                top: 2rem;
                bottom: auto;
                left: auto;
                right: auto;
                height: calc(100vh - 4rem);
                width: auto;
                border-top: none;
                box-shadow: var(--tw-shadow-xl);
            }
        }
    </style>
</head>
<body class="bg-stone-100">

    <div class="main-layout">
        <main>
            <header class="text-center mb-10 border-b-2 border-stone-300 pb-5">
                <h1 id="main-title" class="text-5xl textum-classicum text-gray-800"></h1>
                <h2 id="subtitle" class="text-2xl text-gray-600 mt-2"></h2>
                 <p id="author" class="text-xl text-gray-500 mt-4"></p>
            </header>
            
            <section class="mb-6">
                <h3 id="context-title" class="text-2xl font-semibold text-gray-700 mb-2"></h3>
                <div id="context-content" class="text-justify bg-white p-6 rounded-lg shadow-lg space-y-4"></div>
            </section>
            
            <section>
                 <h3 id="text-title" class="text-2xl font-semibold text-gray-700 mb-2"></h3>
                <div id="paragrafus-contentus" class="textum-classicum text-xl leading-relaxed text-justify bg-white p-8 lg:p-12 rounded-lg shadow-lg"></div>
            </section>
            
            <footer class="text-center mt-6 text-sm text-gray-500">
                <p id="footer-text"></p>
            </footer>
        </main>

        <aside id="marginalia-sinistra" class="bg-white p-6 rounded-t-lg lg:rounded-lg overflow-y-auto">
            <div id="language-switcher" class="mb-4">
                <button data-lang="es" class="lang-btn active-lang">Español</button>
                <button data-lang="en" class="lang-btn">English</button>
                <button data-lang="zh" class="lang-btn">中文 (繁體)</button>
            </div>
            <div id="marginalia-contentus"></div>
        </aside>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // =========================================================================================
        // === INICIO DE LA ZONA DE DATOS ===
        // =========================================================================================
        const corpus = {
            // --- Títulos y Autor ---
            titulus_principalis: "De Bello Gallico, I, 1",
            auctor: "C. Iulius Caesar",
            titulus_secundarius: {
                es: "Comentarios sobre la Guerra de las Galias",
                en: "Commentaries on the Gallic War",
                zh: "高盧戰記"
            },
            // --- Introducción Contextual ---
            introductio: {
                es: {
                    titulus: "Introducción Contextual",
                    contentus: `<p>Los <i>Commentarii de Bello Gallico</i> (Comentarios sobre la Guerra de las Galias) son mucho más que un simple registro de las campañas militares de César (58-50 a.C.). Se trata de una obra maestra de la prosa latina, caracterizada por su claridad, precisión y un estilo directo y sin adornos.</p><p>Escrita en tercera persona para dar una impresión de objetividad, la obra servía como una sofisticada herramienta de propaganda política, destinada a justificar las prolongadas campañas de César ante el Senado y el pueblo de Roma. La frase inicial es icónica por su autoridad y concisión. Con una economía de palabras magistral, César impone un orden romano sobre una realidad geográfica y étnica vasta y compleja. Comienza su relato no con una acción, sino con una definición, estableciendo el escenario del conflicto y demostrando su dominio intelectual sobre el territorio que se disponía a conquistar.</p>`
                },
                en: {
                    titulus: "Contextual Introduction",
                    contentus: `<p>The <i>Commentarii de Bello Gallico</i> (Commentaries on the Gallic War) are much more than a simple record of Caesar's military campaigns (58-50 BC). They are a masterpiece of Latin prose, characterized by clarity, precision, and a direct, unadorned style.</p><p>Written in the third person to give an impression of objectivity, the work served as a sophisticated tool of political propaganda, intended to justify Caesar's prolonged campaigns to the Senate and people of Rome. The opening sentence is iconic for its authority and conciseness. With masterful economy of words, Caesar imposes a Roman order on a vast and complex geographical and ethnic reality. He begins his account not with an action, but with a definition, setting the stage for the conflict and demonstrating his intellectual mastery over the territory he was preparing to conquer.</p>`
                },
                zh: {
                    titulus: "背景介紹",
                    contentus: `<p>《高盧戰記》不僅僅是凱撒軍事行動（西元前58-50年）的簡單記錄。它是拉丁散文的傑作，以其清晰、精確和直白樸實的風格而聞名。</p><p>該書以第三人稱寫成，給人客觀的印象，是當時一種高明的政治宣傳工具，旨在向羅馬的元老院和人民證明凱撒長期軍事行動的正當性。開篇句因其權威性和簡潔性而成為經典。凱撒以精湛的簡約筆觸，將羅馬的秩序強加於一個廣闊而複雜的地理和民族現實之上。他並非以行動開篇，而是以一個定義開始，為衝突設定了舞台，並展示了他對即將征服的領土的智識上的掌控。</p>`
                }
            },
            // --- Texto Principal y Análisis ---
            textus: {
                id: 1,
                orationes: [
                    {
                        id_orationis: 'o1',
                        textus_originalis: "Gallia est omnis divisa in partes tres, quarum unam incolunt Belgae, aliam Aquitani, tertiam qui ipsorum lingua Celtae, nostra Galli appellantur.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>La estructura es una oración compuesta...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>The structure is a compound sentence...</p>` }, zh: { titulus: "句法分析", contentus: `<p>此為一個複合句...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v1_1', terminus: 'Gallia', analysis_morphologicus: 'Sustantivo, femenino, singular, nominativo. Sujeto de "est".', analysis_morphologicus_en: 'Noun, feminine, singular, nominative. Subject of "est".', analysis_morphologicus_zh: '名詞，陰性，單數，主格。「est」的主語。'},
                            { id_verbi: 'v1_2', terminus: 'est', analysis_morphologicus: 'Verbo (\'sum\'), 3ª persona, singular, presente de indicativo. Verbo copulativo.', analysis_morphologicus_en: 'Verb (\'sum\'), 3rd person, singular, present indicative. Copulative verb.', analysis_morphologicus_zh: '動詞（來自「sum」），第三人稱，單數，現在時直陳語態。繫動詞。'},
                            { id_verbi: 'v1_3', terminus: 'omnis', analysis_morphologicus: 'Adjetivo, femenino, singular, nominativo. Concuerda con "Gallia" ("en su totalidad" o "toda").', analysis_morphologicus_en: 'Adjective, feminine, singular, nominative. Agrees with "Gallia" ("as a whole" or "all").', analysis_morphologicus_zh: '形容詞，陰性，單數，主格。修飾「Gallia」（意為「整體的」或「所有的」）。'},
                            { id_verbi: 'v1_4', terminus: 'divisa', analysis_morphologicus: 'Participio perfecto pasivo (\'divido\'), femenino, singular, nominativo. Concuerda con "Gallia". Atributo/Predicado nominal.', analysis_morphologicus_en: 'Perfect passive participle (\'divido\'), feminine, singular, nominative. Agrees with "Gallia". Predicate adjective.', analysis_morphologicus_zh: '完成時被動分詞（來自動詞「divido」），陰性，單數，主格。修飾「Gallia」。表語形容詞。'},
                            { id_verbi: 'v1_5', terminus: 'in', analysis_morphologicus: 'Preposición. Rige acusativo (indica resultado o estado final: "dividida en").', analysis_morphologicus_en: 'Preposition. Governs the accusative (indicates result or final state: "divided into").', analysis_morphologicus_zh: '介詞。支配賓格（表示結果或最終狀態：「劃分為」）。'},
                            { id_verbi: 'v1_6', terminus: 'partes', analysis_morphologicus: 'Sustantivo, femenino, plural, acusativo. Término de la preposición "in".', analysis_morphologicus_en: 'Noun, feminine, plural, accusative. Object of the preposition "in".', analysis_morphologicus_zh: '名詞，陰性，複數，賓格。介詞「in」的賓語。'},
                            { id_verbi: 'v1_7', terminus: 'tres,', analysis_morphologicus: 'Adjetivo numeral cardinal, femenino, plural, acusativo. Concuerda con "partes".', analysis_morphologicus_en: 'Cardinal numeral adjective, feminine, plural, accusative. Agrees with "partes".', analysis_morphologicus_zh: '基數詞形容詞，陰性，複數，賓格。修飾「partes」。'},
                            { id_verbi: 'v1_8', terminus: 'quarum', analysis_morphologicus: 'Pronombre relativo, femenino, plural, genitivo. Referente: "partes tres". Genitivo partitivo ("de las cuales").', analysis_morphologicus_en: 'Relative pronoun, feminine, plural, genitive. Antecedent: "partes tres". Partitive genitive ("of which").', analysis_morphologicus_zh: '關係代名詞，陰性，複數，屬格。先行詞：「partes tres」。部分屬格（「其中的」）。'},
                            { id_verbi: 'v1_9', terminus: 'unam', analysis_morphologicus: 'Adjetivo/pronombre numeral, femenino, singular, acusativo. Objeto directo de "incolunt".', analysis_morphologicus_en: 'Numeral adjective/pronoun, feminine, singular, accusative. Direct object of "incolunt".', analysis_morphologicus_zh: '數詞形容詞/代名詞，陰性，單數，賓格。「incolunt」的直接賓語。'},
                            { id_verbi: 'v1_10', terminus: 'incolunt', analysis_morphologicus: 'Verbo, 3ª persona, plural, presente de indicativo activo.', analysis_morphologicus_en: 'Verb, 3rd person, plural, present indicative active.', analysis_morphologicus_zh: '動詞，第三人稱，複數，現在時直陳主動語態。'},
                            { id_verbi: 'v1_11', terminus: 'Belgae,', analysis_morphologicus: 'Sustantivo (propio), masculino, plural, nominativo. Sujeto de "incolunt".', analysis_morphologicus_en: 'Noun (proper), masculine, plural, nominative. Subject of "incolunt".', analysis_morphologicus_zh: '名詞（專有），陽性，複數，主格。「incolunt」的主語。'},
                            { id_verbi: 'v1_12', terminus: 'aliam', analysis_morphologicus: 'Pronombre indefinido, femenino, singular, acusativo. Objeto directo del "incolunt" elidido (elipsis).', analysis_morphologicus_en: 'Indefinite pronoun, feminine, singular, accusative. Direct object of the implied "incolunt" (ellipsis).', analysis_morphologicus_zh: '不定代名詞，陰性，單數，賓格。省略的「incolunt」的直接賓語（省略）。'},
                            { id_verbi: 'v1_13', terminus: 'Aquitani,', analysis_morphologicus: 'Sustantivo (propio), masculino, plural, nominativo. Sujeto del "incolunt" elidido.', analysis_morphologicus_en: 'Noun (proper), masculine, plural, nominative. Subject of the implied "incolunt".', analysis_morphologicus_zh: '名詞（專有），陽性，複數，主格。省略的「incolunt」的主語。'},
                            { id_verbi: 'v1_14', terminus: 'tertiam', analysis_morphologicus: 'Adjetivo numeral ordinal, femenino, singular, acusativo. Objeto directo del "incolunt" elidido.', analysis_morphologicus_en: 'Ordinal numeral adjective, feminine, singular, accusative. Direct object of the implied "incolunt".', analysis_morphologicus_zh: '序數詞形容詞，陰性，單數，賓格。省略的「incolunt」的直接賓語。'},
                            { id_verbi: 'v1_15', terminus: 'qui', analysis_morphologicus: 'Pronombre relativo, masculino, plural, nominativo. Sujeto de "appellantur" (y sujeto del tercer "incolunt" elidido).', analysis_morphologicus_en: 'Relative pronoun, masculine, plural, nominative. Subject of "appellantur" (and subject of the third implied "incolunt").', analysis_morphologicus_zh: '關係代名詞，陽性，複數，主格。「appellantur」的主語（也是第三個省略的「incolunt」的主語）。'},
                            { id_verbi: 'v1_16', terminus: 'ipsorum', analysis_morphologicus: 'Pronombre intensivo (\'ipse\'), masculino, plural, genitivo. Genitivo posesivo ("de ellos mismos"), modifica a "lingua".', analysis_morphologicus_en: 'Intensive pronoun (\'ipse\'), masculine, plural, genitive. Possessive genitive ("of themselves"), modifies "lingua".', analysis_morphologicus_zh: '強調代名詞（\'ipse\'），陽性，複數，屬格。領屬屬格（「他們自己的」），修飾「lingua」。'},
                            { id_verbi: 'v1_17', terminus: 'lingua', analysis_morphologicus: 'Sustantivo, femenino, singular, ablativo. Ablativo de respeto o instrumental ("en la lengua").', analysis_morphologicus_en: 'Noun, feminine, singular, ablative. Ablative of respect or means ("in the language").', analysis_morphologicus_zh: '名詞，陰性，單數，離格。方面或工具離格（「用...語言」）。'},
                            { id_verbi: 'v1_18', terminus: 'Celtae,', analysis_morphologicus: 'Sustantivo (propio), masculino, plural, nominativo. Predicado nominal de "appellantur".', analysis_morphologicus_en: 'Noun (proper), masculine, plural, nominative. Predicate nominative of "appellantur".', analysis_morphologicus_zh: '名詞（專有），陽性，複數，主格。「appellantur」的表語。'},
                            { id_verbi: 'v1_19', terminus: 'nostra', analysis_morphologicus: 'Adjetivo posesivo, femenino, singular, ablativo. Concuerda con "lingua" elidida ("en la nuestra [lengua]").', analysis_morphologicus_en: 'Possessive adjective, feminine, singular, ablative. Agrees with the implied "lingua" ("in our [language]").', analysis_morphologicus_zh: '物主形容詞，陰性，單數，離格。修飾省略的「lingua」（「用我們的[語言]」）。'},
                            { id_verbi: 'v1_20', terminus: 'Galli', analysis_morphologicus: 'Sustantivo (propio), masculino, plural, nominativo. Predicado nominal de "appellantur".', analysis_morphologicus_en: 'Noun (proper), masculine, plural, nominative. Predicate nominative of "appellantur".', analysis_morphologicus_zh: '名詞（專有），陽性，複數，主格。「appellantur」的表語。'},
                            { id_verbi: 'v1_21', terminus: 'appellantur.', analysis_morphologicus: 'Verbo, 3ª persona, plural, presente de indicativo pasivo ("son llamados").', analysis_morphologicus_en: 'Verb, 3rd person, plural, present indicative passive ("are called").', analysis_morphologicus_zh: '動詞，第三人稱，複數，現在時直陳被動語態（「被稱為」）。'}
                        ]
                    },
                    {
                        id_orationis: 'o2',
                        textus_originalis: "Hi omnes lingua, institutis, legibus inter se differunt.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>Es una oración simple...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>This is a simple sentence...</p>` }, zh: { titulus: "句法分析", contentus: `<p>這是一個簡單句...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v2_1', terminus: 'Hi', analysis_morphologicus: "Pronombre demostrativo ('hic'), masculino, plural, nominativo. Sujeto de 'differunt'.", analysis_morphologicus_en: "Demonstrative pronoun ('hic'), masculine, plural, nominative. Subject of 'differunt'.", analysis_morphologicus_zh: "指示代名詞（'hic'），陽性，複數，主格。「differunt」的主語。" },
                            { id_verbi: 'v2_2', terminus: 'omnes', analysis_morphologicus: "Adjetivo, masculino, plural, nominativo. Concuerda con 'Hi' ('todos').", analysis_morphologicus_en: "Adjective, masculine, plural, nominative. Agrees with 'Hi' ('all').", analysis_morphologicus_zh: "形容詞，陽性，複數，主格。修飾「Hi」（「所有的」）。" },
                            { id_verbi: 'v2_3', terminus: 'lingua,', analysis_morphologicus: "Sustantivo, femenino, singular, ablativo. Ablativo de respeto ('en cuanto a la lengua').", analysis_morphologicus_en: "Noun, feminine, singular, ablative. Ablative of respect ('in respect to language').", analysis_morphologicus_zh: "名詞，陰性，單數，離格。方面離格（「在語言方面」）。" },
                            { id_verbi: 'v2_4', terminus: 'institutis,', analysis_morphologicus: "Sustantivo, neutro, plural, ablativo. Ablativo de respeto ('en cuanto a las costumbres').", analysis_morphologicus_en: "Noun, neuter, plural, ablative. Ablative of respect ('in respect to customs/institutions').", analysis_morphologicus_zh: "名詞，中性，複數，離格。方面離格（「在習俗/制度方面」）。" },
                            { id_verbi: 'v2_5', terminus: 'legibus', analysis_morphologicus: "Sustantivo, femenino, plural, ablativo. Ablativo de respeto ('en cuanto a las leyes').", analysis_morphologicus_en: "Noun, feminine, plural, ablative. Ablative of respect ('in respect to laws').", analysis_morphologicus_zh: "名詞，陰性，複數，離格。方面離格（「在法律方面」）。" },
                            { id_verbi: 'v2_6', terminus: 'inter', analysis_morphologicus: "Preposición. Rige acusativo ('entre').", analysis_morphologicus_en: "Preposition. Governs the accusative ('between' or 'among').", analysis_morphologicus_zh: "介詞。支配賓格（「在...之間」）。" },
                            { id_verbi: 'v2_7', terminus: 'se', analysis_morphologicus: "Pronombre reflexivo, acusativo. Usado con 'inter' para formar la expresión recíproca 'inter se' ('entre sí').", analysis_morphologicus_en: "Reflexive pronoun, accusative. Used with 'inter' to form the reciprocal expression 'inter se' ('among themselves').", analysis_morphologicus_zh: "反身代名詞，賓格。與「inter」連用，構成相互關係表達「inter se」（「彼此之間」）。" },
                            { id_verbi: 'v2_8', terminus: 'differunt.', analysis_morphologicus: "Verbo ('differo'), 3ª persona, plural, presente de indicativo activo.", analysis_morphologicus_en: "Verb ('differo'), 3rd person, plural, present indicative active.", analysis_morphologicus_zh: "動詞（'differo'），第三人稱，複數，現在時直陳主動語態。" }
                        ]
                    },
                    {
                        id_orationis: 'o3',
                        textus_originalis: "Gallos ab Aquitanis Garumna flumen, a Belgis Matrona et Sequana diuidit.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>Oración simple con sujeto compuesto...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>A simple sentence with a compound subject...</p>` }, zh: { titulus: "句法分析", contentus: `<p>帶有複合主語的簡單句...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v3_1', terminus: 'Gallos', analysis_morphologicus: "Sustantivo (propio), masculino, plural, acusativo. Objeto directo de 'dividit'.", analysis_morphologicus_en: "Noun (proper), masculine, plural, accusative. Direct object of 'dividit'.", analysis_morphologicus_zh: "名詞（專有），陽性，複數，賓格。「dividit」的直接賓語。" },
                            { id_verbi: 'v3_2', terminus: 'ab', analysis_morphologicus: "Preposición. Rige ablativo. Indica separación ('de').", analysis_morphologicus_en: "Preposition. Governs the ablative. Indicates separation ('from').", analysis_morphologicus_zh: "介詞。支配離格。表示分離（「從」）。" },
                            { id_verbi: 'v3_3', terminus: 'Aquitanis', analysis_morphologicus: "Sustantivo (propio), masculino, plural, ablativo. Término de la preposición 'ab'.", analysis_morphologicus_en: "Noun (proper), masculine, plural, ablative. Object of the preposition 'ab'.", analysis_morphologicus_zh: "名詞（專有），陽性，複數，離格。介詞「ab」的賓語。" },
                            { id_verbi: 'v3_4', terminus: 'Garumna', analysis_morphologicus: "Sustantivo (propio, río Garona), femenino, singular, nominativo. Sujeto de 'dividit'.", analysis_morphologicus_en: "Noun (proper, Garonne river), feminine, singular, nominative. Subject of 'dividit'.", analysis_morphologicus_zh: "名詞（專有，加龍河），陰性，單數，主格。「dividit」的主語。" },
                            { id_verbi: 'v3_5', terminus: 'flumen,', analysis_morphologicus: "Sustantivo, neutro, singular, nominativo. Aposición a 'Garumna' ('el río').", analysis_morphologicus_en: "Noun, neuter, singular, nominative. In apposition to 'Garumna' ('the river').", analysis_morphologicus_zh: "名詞，中性，單數，主格。「Garumna」的同位語（「河流」）。" },
                            { id_verbi: 'v3_6', terminus: 'a', analysis_morphologicus: "Preposición (variante de 'ab' ante consonante). Rige ablativo. Indica separación ('de').", analysis_morphologicus_en: "Preposition (variant of 'ab' before a consonant). Governs the ablative. Indicates separation ('from').", analysis_morphologicus_zh: "介詞（'ab'在輔音前的變體）。支配離格。表示分離（「從」）。" },
                            { id_verbi: 'v3_7', terminus: 'Belgis', analysis_morphologicus: "Sustantivo (propio), masculino, plural, ablativo. Término de la preposición 'a'.", analysis_morphologicus_en: "Noun (proper), masculine, plural, ablative. Object of the preposition 'a'.", analysis_morphologicus_zh: "名詞（專有），陽性，複數，離格。介詞「a」的賓語。" },
                            { id_verbi: 'v3_8', terminus: 'Matrona', analysis_morphologicus: "Sustantivo (propio, río Marne), femenino, singular, nominativo. Sujeto de 'dividit'.", analysis_morphologicus_en: "Noun (proper, Marne river), feminine, singular, nominative. Subject of 'dividit'.", analysis_morphologicus_zh: "名詞（專有，馬恩河），陰性，單數，主格。「dividit」的主語。" },
                            { id_verbi: 'v3_9', terminus: 'et', analysis_morphologicus: "Conjunción coordinante ('y').", analysis_morphologicus_en: "Coordinating conjunction ('and').", analysis_morphologicus_zh: "並列連詞（「和」）。" },
                            { id_verbi: 'v3_10', terminus: 'Sequana', analysis_morphologicus: "Sustantivo (propio, río Sena), femenino, singular, nominativo. Sujeto de 'dividit'.", analysis_morphologicus_en: "Noun (proper, Seine river), feminine, singular, nominative. Subject of 'dividit'.", analysis_morphologicus_zh: "名詞（專有，塞納河），陰性，單數，主格。「dividit」的主語。" },
                            { id_verbi: 'v3_11', terminus: 'diuidit.', analysis_morphologicus: "Verbo ('divido'), 3ª persona, singular, presente de indicativo activo.", analysis_morphologicus_en: "Verb ('divido'), 3rd person, singular, present indicative active.", analysis_morphologicus_zh: "動詞（'divido'），第三人稱，單數，現在時直陳主動語態。" }
                        ]
                    },
                    {
                        id_orationis: 'o4',
                        textus_originalis: "Horum omnium fortissimi sunt Belgae, propterea quod a cultu atque humanitate prouinciae longissime absunt, minimeque ad eos mercatores saepe commeant atque ea quae ad effeminandos animos pertinent inportant, proximique sunt Germanis, qui trans Rhenum incolunt, quibuscum continenter bellum gerunt.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>Oración compleja...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>A complex sentence...</p>` }, zh: { titulus: "句法分析", contentus: `<p>這是一個複雜句...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v4_1', terminus: 'Horum', analysis_morphologicus: "Pronombre demostrativo ('hic'), masculino, plural, genitivo. Genitivo partitivo ('De estos').", analysis_morphologicus_en: "Demonstrative pronoun ('hic'), masculine, plural, genitive. Partitive genitive ('Of these').", analysis_morphologicus_zh: "指示代名詞（'hic'），陽性，複數，屬格。部分屬格（「這些中的」）。" },
                            { id_verbi: 'v4_36', terminus: 'gerunt.', analysis_morphologicus: "Verbo ('gero'), 3ª persona, plural, presente de indicativo activo ('libran').", analysis_morphologicus_en: "Verb ('gero'), 3rd person, plural, present indicative active ('wage').", analysis_morphologicus_zh: "動詞（'gero'），第三人稱，複數，現在時直陳主動語態（「進行」）。" }
                        ]
                    },
                    {
                        id_orationis: 'o5',
                        textus_originalis: "Qua de causa Heluetii quoque reliquos Gallos uirtute praecedunt, quod fere cotidianis proeliis cum Germanis contendunt, cum aut suis finibus eos prohibent, aut ipsi in eorum finibus bellum gerunt.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>La oración principal es...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>The main sentence is...</p>` }, zh: { titulus: "句法分析", contentus: `<p>主句是...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v5_1', terminus: 'Qua de causa', analysis_morphologicus: "Locución ablativa ('Por esta razón').", analysis_morphologicus_en: "Ablative phrase ('For this reason').", analysis_morphologicus_zh: "離格短語（「因此」）。" },
                            { id_verbi: 'v5_25', terminus: 'gerunt.', analysis_morphologicus: "Verbo ('gero'), 3ª persona, plural, presente de indicativo activo ('hacen').", analysis_morphologicus_en: "Verb ('gero'), 3rd person, plural, present indicative active ('wage').", analysis_morphologicus_zh: "動詞（'gero'），第三人稱，複數，現在時直陳主動語態（「進行」）。" }
                        ]
                    },
                    {
                        id_orationis: 'o6',
                        textus_originalis: "Eorum una pars, quam Gallos optinere dictum est, initium capit a flumine Rhodano, continentur Garumna flumine, Oceano, finibus Belgarum, attingit etiam ab Sequanis et Heluetiis flumen Rhenum, uergit ad septentriones.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>Oración muy compleja...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>A very complex sentence...</p>` }, zh: { titulus: "句法分析", contentus: `<p>一個非常複雜的句子...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v6_1', terminus: 'Eorum', analysis_morphologicus: "Pronombre ('is'), masculino/neutro, plural, genitivo. Genitivo partitivo ('De estos/ellas').", analysis_morphologicus_en: "Pronoun ('is'), masculine/neuter, plural, genitive. Partitive genitive ('Of these/them').", analysis_morphologicus_zh: "代名詞（'is'），陽性/中性，複數，屬格。部分屬格（「這些/它們中的」）。" },
                            { id_verbi: 'v6_29', terminus: 'septentriones.', analysis_morphologicus: "Sustantivo, masculino, plural, acusativo ('el norte').", analysis_morphologicus_en: "Noun, masculine, plural, accusative ('the north').", analysis_morphologicus_zh: "名詞，陽性，複數，賓格（「北方」）。" }
                        ]
                    },
                    {
                        id_orationis: 'o7',
                        textus_originalis: "Belgae ab extremis Galliae finibus oriuntur, pertinent ad inferiorem partem fluminis Rheni, spectant in septentrionem et orientem solem.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>Oración compuesta por coordinación...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>A compound sentence...</p>` }, zh: { titulus: "句法分析", contentus: `<p>由並列構成的複合句...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v7_1', terminus: 'Belgae', analysis_morphologicus: "Sustantivo (propio), masculino, plural, nominativo. Sujeto.", analysis_morphologicus_en: "Noun (proper), masculine, plural, nominative. Subject.", analysis_morphologicus_zh: "名詞（專有），陽性，複數，主格。主語。" },
                            { id_verbi: 'v7_17', terminus: 'orientem solem.', analysis_morphologicus: "Construcción acusativa ('hacia el sol naciente', el este).", analysis_morphologicus_en: "Accusative phrase ('toward the rising sun', the east).", analysis_morphologicus_zh: "賓格短語（「向著升起的太陽」，即東方）。" }
                        ]
                    },
                    {
                        id_orationis: 'o8',
                        textus_originalis: "Aquitania Garumna flumen ad Pyrenaeos montes et eam partem Oceani quae est ad Hispaniam pertinet; spectat inter occasum solis et septentriones.",
                        analysis_syntacticus: { es: { titulus: "Análisis Sintáctico", contentus: `<p>Oración con un único sujeto...</p>` }, en: { titulus: "Syntactic Analysis", contentus: `<p>A sentence with a single subject...</p>` }, zh: { titulus: "句法分析", contentus: `<p>一個單主語句子...</p>` } },
                        translationes_explicatae: { es: { titulus: "Traducciones y Comentarios", contentus: `<p><b>Traducción Literal:</b>...</p>` }, en: { titulus: "Translations & Commentary", contentus: `<p><b>Literal Translation:</b>...</p>` }, zh: { titulus: "翻譯與註釋", contentus: `<p><b>直譯：</b>...</p>` } },
                        verba: [
                            { id_verbi: 'v8_1', terminus: 'Aquitania', analysis_morphologicus: "Sustantivo (propio), femenino, singular, nominativo. Sujeto.", analysis_morphologicus_en: "Noun (proper), feminine, singular, nominative. Subject.", analysis_morphologicus_zh: "名詞（專有），陰性，單數，主格。主語。" },
                            { id_verbi: 'v8_20', terminus: 'septentriones.', analysis_morphologicus: "Sustantivo, masculino, plural, acusativo ('el norte').", analysis_morphologicus_en: "Noun, masculine, plural, accusative ('the north').", analysis_morphologicus_zh: "名詞，陽性，複數，賓格（「北方」）。" }
                        ]
                    },
                    // === CORRECCIÓN: La oración 9 se ha movido aquí, dentro del array 'orationes' ===
                    {
                        id_orationis: 'o9',
                        textus_originalis: "Apud Heluetios longe nobilissimus fuit et ditissimus Orgetorix.",
                        analysis_syntacticus: {
                            es: {
                                titulus: "Análisis Sintáctico",
                                contentus: `<p>La oración tiene una estructura de hipérbaton para dar énfasis al sujeto. El <b>verbo principal</b> es "<i>fuit</i>". El <b>sujeto</b> es "<i>Orgetorix</i>", colocado al final. "<i>Nobilissimus</i>" y "<i>ditissimus</i>" son el <b>predicado nominal</b> (atributo) del sujeto. "<i>Longe</i>" intensifica a los superlativos y "<i>Apud Heluetios</i>" es un <b>complemento circunstancial de lugar</b>.</p>`
                            },
                            en: {
                                titulus: "Syntactic Analysis",
                                contentus: `<p>The sentence uses hyperbaton for emphasis. The <b>main verb</b> is "<i>fuit</i>". The <b>subject</b> is "<i>Orgetorix</i>", placed at the end. "<i>Nobilissimus</i>" and "<i>ditissimus</i>" function as the <b>predicate nominative</b> (attribute) of the subject. "<i>Longe</i>" intensifies the superlatives, and "<i>Apud Heluetios</i>" is a <b>circumstantial complement of place</b>.</p>`
                            },
                            zh: {
                                titulus: "句法分析",
                                contentus: `<p>此句採用倒裝法以示強調。<b>主要動詞</b>是「<i>fuit</i>」。<b>主語</b>是置於句末的「<i>Orgetorix</i>」。「<i>Nobilissimus</i>」和「<i>ditissimus</i>」是主語的<b>主格表語</b>（屬性）。「<i>Longe</i>」加強了最高級形容詞的語氣，而「<i>Apud Heluetios</i>」則是<b>地點狀語補語</b>。</p>`
                            }
                        },
                        translationes_explicatae: {
                            es: {
                                titulus: "Traducciones y Comentarios",
                                contentus: `<p><b>Traducción Literal:</b><br><i>Entre los helvecios, de lejos el más noble fue y el más rico Orgetorix.</i></p><p><b>Traducción Idiomática:</b><br><i>Orgetorix era, con diferencia, el más noble y rico de los helvecios.</i></p>`
                            },
                            en: {
                                titulus: "Translations & Commentary",
                                contentus: `<p><b>Literal Translation:</b><br><i>Among the Helvetii, by far the most noble was and the richest Orgetorix.</i></p><p><b>Idiomatic Translation:</b><br><i>By far the most noble and wealthy among the Helvetii was Orgetorix.</i></p>`
                            },
                            zh: {
                                titulus: "翻譯與註釋",
                                contentus: `<p><b>直譯：</b><br><i>在赫爾維蒂人中，最為尊貴且最為富有的是奧格托里克斯。</i></p><p><b>意譯：</b><br><i>在赫爾維蒂人當中，奧格托里克斯無疑是最高貴、最富有的人。</i></p>`
                            }
                        },
                        verba: [
                            { id_verbi: 'v9_1', terminus: 'Apud', analysis_morphologicus: "Preposición (rige acusativo).", analysis_morphologicus_en: "Preposition (governs accusative).", analysis_morphologicus_zh: "介詞 (支配賓格)。" },
                            { id_verbi: 'v9_2', terminus: 'Heluetios', analysis_morphologicus: "Sustantivo, masculino, plural, acusativo.", analysis_morphologicus_en: "Noun, masculine, plural, accusative.", analysis_morphologicus_zh: "名詞，陽性，複數，賓格。" },
                            { id_verbi: 'v9_3', terminus: 'longe', analysis_morphologicus: "Adverbio.", analysis_morphologicus_en: "Adverb.", analysis_morphologicus_zh: "副詞。" },
                            { id_verbi: 'v9_4', terminus: 'nobilissimus', analysis_morphologicus: "Adjetivo, masculino, singular, nominativo (grado superlativo de nobilis).", analysis_morphologicus_en: "Adjective, masculine, singular, nominative (superlative degree of nobilis).", analysis_morphologicus_zh: "形容詞，陽性，單數，主格 (nobilis 的最高級)。" },
                            { id_verbi: 'v9_5', terminus: 'fuit', analysis_morphologicus: "Verbo, 3ª persona del singular, pretérito perfecto de indicativo, activo (de sum).", analysis_morphologicus_en: "Verb, 3rd person singular, perfect indicative, active (from sum).", analysis_morphologicus_zh: "動詞，第三人稱單數，完成式，主動語態，直陳法 (來自 sum)。" },
                            { id_verbi: 'v9_6', terminus: 'et', analysis_morphologicus: "Conjunción copulativa.", analysis_morphologicus_en: "Coordinating conjunction.", analysis_morphologicus_zh: "並列連詞。" },
                            { id_verbi: 'v9_7', terminus: 'ditissimus', analysis_morphologicus: "Adjetivo, masculino, singular, nominativo (grado superlativo de dis).", analysis_morphologicus_en: "Adjective, masculine, singular, nominative (superlative degree of dis).", analysis_morphologicus_zh: "形容詞，陽性，單數，主格 (dis 的最高級)。" },
                            { id_verbi: 'v9_8', terminus: 'Orgetorix.', analysis_morphologicus: "Sustantivo propio, masculino, singular, nominativo.", analysis_morphologicus_en: "Proper noun, masculine, singular, nominative.", analysis_morphologicus_zh: "專有名詞，陽性，單數，主格。" }
                        ]
                    }
                ]
            }
        };
        // =========================================================================================
        // === FIN DE LA ZONA DE DATOS ===
        // (No es necesario editar nada debajo de esta línea)
        // =========================================================================================

        const mainTitle = document.getElementById('main-title');
        const subtitle = document.getElementById('subtitle');
        const author = document.getElementById('author');
        const contextTitle = document.getElementById('context-title');
        const contextContent = document.getElementById('context-content');
        const textTitle = document.getElementById('text-title');
        const paragrafusContentus = document.getElementById('paragrafus-contentus');
        const marginaliaContentus = document.getElementById('marginalia-contentus');
        const languageSwitcher = document.getElementById('language-switcher');
        const footerText = document.getElementById('footer-text');

        let idiomaActivo = 'es';
        let activumVerbum = null;
        let activaOratio = null;

        const langConfig = {
            en: { analysisTitle: 'Morphological Analysis', textTitle: 'Text for Analysis', selectWordText: 'Select a word to see its analysis.', footerTextContent: '<i>Click a word to see its analysis and details of the sentence.</i>' },
            es: { analysisTitle: 'Análisis Morfológico', textTitle: 'Texto para Analizar', selectWordText: 'Seleccione una palabra para ver su análisis.', footerTextContent: '<i>Haz clic en una palabra para ver su análisis y los detalles de la oración.</i>' },
            zh: { analysisTitle: '詞法分析', textTitle: '分析文本', selectWordText: '請選取一個單字以查看其分析。', footerTextContent: '<i>點擊一個單字以查看其分析及句子詳情。</i>' }
        };

        function initialRender() {
            idiomaActivo = document.querySelector('.lang-btn.active-lang').dataset.lang || 'es';
            mainTitle.textContent = corpus.titulus_principalis;
            author.textContent = corpus.auctor;
            
            updateStaticContent();
            reddeParagrafum();
            actualizaMarginalia();
        }

        function updateStaticContent() {
            const config = langConfig[idiomaActivo];
            subtitle.textContent = corpus.titulus_secundarius[idiomaActivo];
            contextTitle.textContent = corpus.introductio[idiomaActivo].titulus;
            contextContent.innerHTML = corpus.introductio[idiomaActivo].contentus;
            textTitle.textContent = config.textTitle;
            footerText.innerHTML = config.footerTextContent;
        }

        function reddeParagrafum() {
            let fullText = corpus.textus.orationes.map(o => o.textus_originalis).join(' ');
            let allVerba = corpus.textus.orationes.flatMap(o => o.verba.map(v => ({...v, oratioId: o.id_orationis})));
            allVerba.sort((a,b) => b.terminus.replace(/[,.·;:]/g, '').length - a.terminus.replace(/[,.·;:]/g, '').length);
            
            allVerba.forEach(verbum => {
                const cleanTerminus = verbum.terminus.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                const regex = new RegExp(`(${cleanTerminus})(?![^<]*?>|[^<>]*?<\\/)`, 'g');
                const replacement = `<span class="verbum" data-verbum-id="${verbum.id_verbi}" data-oratio-id="${verbum.oratioId}">$1</span>`;
                fullText = fullText.replace(regex, replacement);
            });
            paragrafusContentus.innerHTML = fullText;
        }
        
        function actualizaMarginalia() {
            let htmlContentus = '';
            const config = langConfig[idiomaActivo];

            htmlContentus += `<section id="analysis-morphologicus-section" class="mb-6"><h3 class="text-xl font-semibold text-gray-800 mb-4">${config.analysisTitle}</h3>`;
            
            if (activumVerbum) {
                const analysisText = activumVerbum[`analysis_morphologicus_${idiomaActivo}`] || activumVerbum.analysis_morphologicus;
                htmlContentus += `
                        <h4 class="text-2xl textum-classicum text-gray-800 mb-4">${activumVerbum.terminus}</h4>
                        <div class="space-y-4">
                            <div><p class="text-gray-700 mt-1">${analysisText}</p></div>
                        </div>`;
            } else {
                htmlContentus += `<div class="p-4 bg-stone-200 rounded-md text-gray-600"><p>${config.selectWordText}</p></div>`;
            }
            htmlContentus += `</section>`;

            if (activaOratio) {
                const syntaxis = activaOratio.analysis_syntacticus[idiomaActivo];
                const translationes = activaOratio.translationes_explicatae[idiomaActivo];

                htmlContentus += `<hr class="border-stone-300 my-6">`;
                
                // --- Menú Desplegable para Análisis Sintáctico ---
                htmlContentus += `
                    <section id="analysis-sintacticus-section" class="mb-4">
                        <details>
                            <summary class="text-xl font-semibold text-gray-800 mb-2">${syntaxis.titulus}</summary>
                            <div class="details-content text-sm text-gray-700">${syntaxis.contentus}</div>
                        </details>
                    </section>`;

                // --- Menú Desplegable para Traducciones ---
                htmlContentus += `
                    <section id="analysis-translationes-section">
                         <details>
                            <summary class="text-xl font-semibold text-gray-800 mb-2">${translationes.titulus}</summary>
                            <div class="details-content text-sm text-gray-700">${translationes.contentus}</div>
                        </details>
                    </section>`;
            }
            
            marginaliaContentus.innerHTML = htmlContentus;
        }

        paragrafusContentus.addEventListener('click', (e) => {
            const verbumTarget = e.target.closest('.verbum');
            if (!verbumTarget) {
                if (!e.target.closest('#marginalia-sinistra')) {
                    document.querySelectorAll('.activus').forEach(el => el.classList.remove('activus'));
                    activumVerbum = null;
                    activaOratio = null;
                    actualizaMarginalia();
                }
                return;
            }

            const isAlreadyActive = verbumTarget.classList.contains('activus');
            document.querySelectorAll('.activus').forEach(el => el.classList.remove('activus'));
            
            if (isAlreadyActive) {
                activumVerbum = null;
                activaOratio = null;
            } else {
                const verbumId = verbumTarget.dataset.verbumId;
                const oratioId = verbumTarget.dataset.oratioId;
                activaOratio = corpus.textus.orationes.find(o => o.id_orationis === oratioId);
                if (activaOratio) {
                    activumVerbum = activaOratio.verba.find(v => v.id_verbi === verbumId);
                }
                verbumTarget.classList.add('activus');
            }
            actualizaMarginalia();
        });

        languageSwitcher.addEventListener('click', (e) => {
            const targetBtn = e.target.closest('.lang-btn');
            if (!targetBtn) return;
            
            const newLang = targetBtn.dataset.lang;
            if (newLang === idiomaActivo) return;
            
            idiomaActivo = newLang;
            
            languageSwitcher.querySelector('.active-lang').classList.remove('active-lang');
            targetBtn.classList.add('active-lang');
            
            updateStaticContent();
            actualizaMarginalia();
        });

        initialRender();
    });
    </script>
</body>
</html>
